"use strict";(()=>{var e={};e.id=912,e.ids=[912],e.modules={11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},63477:e=>{e.exports=require("querystring")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},32341:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>m,originalPathname:()=>g,patchFetch:()=>x,requestAsyncStorage:()=>c,routeModule:()=>l,serverHooks:()=>d,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>h});var a={};r.r(a),r.d(a,{GET:()=>u,POST:()=>u});var i=r(95419),n=r(69108),o=r(99678),s=r(53407);let u=(0,r(49605).default)(s.L),l=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"D:\\PIAIC course\\Projects\\demo_e-commerce\\FrontEnd\\src\\app\\api\\auth\\[...nextauth]\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:c,staticGenerationAsyncStorage:p,serverHooks:d,headerHooks:m,staticGenerationBailout:h}=l,g="/api/auth/[...nextauth]/route";function x(){return(0,o.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:p})}},86485:(e,t)=>{t.Z=function(e){return{id:"credentials",name:"Credentials",type:"credentials",credentials:{},authorize:()=>null,options:e}}},50694:(e,t)=>{t.Z=function(e){return{id:"github",name:"GitHub",type:"oauth",authorization:{url:"https://github.com/login/oauth/authorize",params:{scope:"read:user user:email"}},token:"https://github.com/login/oauth/access_token",userinfo:{url:"https://api.github.com/user",async request({client:e,tokens:t}){let r=await e.userinfo(t.access_token);if(!r.email){let e=await fetch("https://api.github.com/user/emails",{headers:{Authorization:`token ${t.access_token}`}});if(e.ok){var a;let t=await e.json();r.email=(null!==(a=t.find(e=>e.primary))&&void 0!==a?a:t[0]).email}}return r}},profile(e){var t;return{id:e.id.toString(),name:null!==(t=e.name)&&void 0!==t?t:e.login,email:e.email,image:e.avatar_url}},style:{logo:"/github.svg",bg:"#24292f",text:"#fff"},options:e}}},95419:(e,t,r)=>{e.exports=r(30517)},83701:(e,t,r)=>{r.d(t,{Z:()=>o});var a=r(11185),i=r.n(a);let n=new(i()).Schema({firstname:{type:String},lastname:{type:String},email:{type:String},password:{type:String},role:{type:String},resetToken:{type:String,required:!1},resetTokenExpiry:{type:Date,required:!1}},{timestamps:!0}),o=a.models.User||i().model("User",n)},53407:(e,t,r)=>{r.d(t,{L:()=>l});var a=r(50694),i=r(86485),n=r(6521),o=r.n(n),s=r(83701),u=r(60134);let l={providers:[(0,i.Z)({id:"credentials",name:"Credentials",credentials:{email:{label:"Email",type:"text"},password:{label:"Password",type:"password"}},async authorize(e){await (0,u.Z)();try{let t=await s.Z.findOne({email:e.email});if(t&&await o().compare(e.password,t.password))return t}catch(e){throw Error(e)}}}),(0,a.Z)({clientId:process.env.GITHUB_ID??"",clientSecret:process.env.GITHUB_SECRET??""})],callbacks:{async signIn({user:e,account:t}){if(t?.provider=="credentials")return!0;if(t?.provider=="github"){await (0,u.Z)();try{if(!await s.Z.findOne({email:e.email})){let t=new s.Z({email:e.email});await t.save()}}catch(e){return console.log("Error saving user",e),!1}}return!0}}}},60134:(e,t,r)=>{r.d(t,{Z:()=>n});var a=r(11185),i=r.n(a);let n=async()=>{if(!i().connections[0].readyState)try{await i().connect(process.env.DB_CONNECTION,{useNewUrlParser:!0,useUnifiedTopology:!0}),console.log("Mongo Connection successfully established.")}catch(e){throw Error("Error connecting to Mongoose")}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,605,521],()=>r(32341));module.exports=a})();